/*********************************************************************************************************
* 模块名称: GeneralQueue.c
* 摘    要:
* 当前版本: 1.0.0
* 作    者: SZLY(COPYRIGHT 2019 SZLY. All rights reserved.)
* 完成日期: 2019年08月01日
* 内    容:
* 注    意:
**********************************************************************************************************
* 取代版本:
* 作    者:
* 完成日期:
* 修改内容:
* 修改文件:
*********************************************************************************************************/

/*********************************************************************************************************
*                                              包含头文件
*********************************************************************************************************/
#include "GeneralQueue.h"

/*********************************************************************************************************
*                                              宏定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              枚举结构体定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部变量
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部函数声明
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部函数实现
*********************************************************************************************************/

/*********************************************************************************************************
*                                              API函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称: InitGeneralQueue
* 函数功能: 初始化通用队列
* 输入参数: queue：队列
* 输出参数: void
* 返 回 值: void
* 创建日期: 2019年08月01日
* 注    意: 
*********************************************************************************************************/
void InitGeneralQueue(StructGeneralCirQue* queue)
{
  ClearGeneralQueue(queue);
}

/*********************************************************************************************************
* 函数名称: IsGeneralQueueEmpty
* 函数功能: 判断队列是否非空
* 输入参数: queue：队列
* 输出参数: void
* 返 回 值: 1-队列为空，其它-队列非空
* 创建日期: 2019年08月01日
* 注    意:
*********************************************************************************************************/
int IsGeneralQueueEmpty(StructGeneralCirQue* queue)
{
  return 0 == queue->elemNum;
}

/*********************************************************************************************************
* 函数名称: IsGeneralQueueFull
* 函数功能: 判断队列是否为满
* 输入参数: queue：队列
* 输出参数: void
* 返 回 值: 1-队列为满，其它-队列非满
* 创建日期: 2019年08月01日
* 注    意:
*********************************************************************************************************/
int IsGeneralQueueFull(StructGeneralCirQue* queue)
{
  return queue->bufLen == queue->elemNum;
}

/*********************************************************************************************************
* 函数名称: ClearGeneralQueue
* 函数功能: 清空队列
* 输入参数: queue：队列
* 输出参数: void
* 返 回 值: void
* 创建日期: 2019年08月01日
* 注    意:
*********************************************************************************************************/
void ClearGeneralQueue(StructGeneralCirQue* queue)
{
  //清空当前队列数据量
  queue->elemNum = 0;

  //初始化队首
  queue->front = 0;

  //初始化队尾
  queue->rear = 0;
}

/*********************************************************************************************************
* 函数名称: GetrGeneralQueueLength
* 函数功能: 返回队列中元素个数
* 输入参数: queue：队列
* 输出参数: void
* 返 回 值: 队列中元素个数
* 创建日期: 2019年08月01日
* 注    意:
*********************************************************************************************************/
u32 GetrGeneralQueueLength(StructGeneralCirQue* queue)
{
  return queue->elemNum;
}

/*********************************************************************************************************
* 函数名称: EnGeneralQueue
* 函数功能: 入队
* 输入参数: queue：队列，data：数据地址
* 输出参数: void
* 返 回 值: void
* 创建日期: 2019年08月01日
* 注    意: 在调用时data要强制转换成void指针，若填入时队列已满，则自动丢弃队首数据
*********************************************************************************************************/
void EnGeneralQueue(StructGeneralCirQue* queue, void* data)
{
  u32 i = 0;

  //若当前队列未满
  if (IsGeneralQueueFull(queue))
  {
    queue->elemNum = queue->bufLen;
    queue->front = (queue->front + 1) % queue->bufLen;
  }
  else
  {
    queue->elemNum++;
  }

  //将数据添加到队首中
  for (i = 0; i < queue->typeSize; i++)
  {
    *(u8*)((u8*)(queue->buf) + queue->rear * queue->typeSize + i) = *(u8*)((u8*)data + i);
  }

  //队尾加一
  queue->rear = (queue->rear + 1) % queue->bufLen;
}

/*********************************************************************************************************
* 函数名称: DeGeneralQueue
* 函数功能: 出队
* 输入参数: queue：队列
* 输出参数: void
* 返 回 值: 数据地址，失败返回NULL
* 创建日期: 2019年08月01日
* 注    意: 读取数据时要强制转换成相应类型
*********************************************************************************************************/
void* DeGeneralQueue(StructGeneralCirQue* queue)
{
  void* temp = NULL;

  //队列为空则返回NULL
  if (IsGeneralQueueEmpty(queue))
  {
    return NULL;
  }
  else
  {
    //返回当前队首地址
    temp = (u8*)(queue->buf) + queue->front * queue->typeSize;

    //当前队列数据量减一
    queue->elemNum--;

    //队首往后挪
    queue->front = (queue->front + 1) % queue->bufLen;

    //返回队首地址
    return temp;
  }
}


